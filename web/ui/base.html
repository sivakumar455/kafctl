{{define "title"}}home{{end}}

{{ define "kaf-header" }}
<header class="my-4 text-center w-100">
    <h1 class="kafview-brand">
        <a href='/' class="kafview-brand-link">
            <span class="kafview-icon">
                <i class="bi bi-lightning-charge-fill"></i>
            </span>
            <span class="kafview-text">
                <span class="kafview-kaf">kaf</span><span class="kafview-view">View</span>
            </span>
        </a>
    </h1>
    <p class="kafview-tagline text-muted mb-0">Kafka Management Dashboard</p>
</header>
{{end}}

{{define "home-header"}}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top shadow-sm">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="/">
            <i class="bi bi-house-door-fill me-2"></i>
            <span class="fw-bold">Home</span>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/" hx-boost="true">
                        <i class="bi bi-house me-1"></i>Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" hx-get="/createtopicform" hx-trigger="click" hx-target="body" hx-swap="outerHTML">
                        <i class="bi bi-plus-circle me-1"></i>Create Topic
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" hx-get="/publishform" hx-trigger="click" hx-target="body" hx-swap="outerHTML">
                        <i class="bi bi-send me-1"></i>Publish Message
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" onclick="window.location.reload(); return false;">
                        <i class="bi bi-arrow-clockwise me-1"></i>Refresh
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div class="row justify-content-center">
    <div class="col-12">
        {{ template "kaf-header"}}
    </div>
</div>
{{end}}

{{ define "kaf-footer"}}
<footer class="my-4 text-center">Powered by <a href='https://golang.org/'>Go</a></footer>
{{end}}

{{define "topics"}}
<div class="p-3 border-bottom bg-light">
    <div class="input-group">
        <span class="input-group-text"><i class="bi bi-search"></i></span>
        <input type="text" class="form-control" id="search-input" placeholder="Search topics by name..."
               onkeyup="filterTopics()">
        <span class="input-group-text">
            <span class="badge bg-secondary" data-original-count="{{len .Topics}}">{{len .Topics}}</span>
        </span>
    </div>
</div>
<div class="table-responsive">
    <table class="table table-hover table-bordered mb-0" id="topics-table">
        <thead class="table-light">
            <tr>
                <th><i class="bi bi-stack me-1"></i>Topic Name</th>
                <th class="text-center"><i class="bi bi-layers me-1"></i>Partitions</th>
                <th class="text-center"><i class="bi bi-files me-1"></i>Replicas</th>
                <th class="text-center"><i class="bi bi-check-circle me-1"></i>ISRs</th>
                <th class="text-center"><i class="bi bi-gear me-1"></i>Actions</th>
            </tr>
        </thead>
        <tbody>
            {{range $topicName, $topicMetadata := .Topics}}
            <tr class="topic-row">
                <td>
                    <a href="#" class="text-decoration-none fw-bold" 
                       hx-get="/topic-details?name={{$topicName}}" 
                       hx-trigger="click" 
                       hx-target="body" 
                       hx-swap="outerHTML">
                        <i class="bi bi-box-arrow-up-right me-1"></i>{{$topicName}}
                    </a>
                </td>
                <td class="text-center">
                    <span class="badge bg-info">{{len $topicMetadata.Partitions}}</span>
                </td>
                <td class="text-center">
                    <span class="badge bg-success">{{countReplicas $topicMetadata.Partitions}}</span>
                </td>
                <td class="text-center">
                    <span class="badge bg-primary">{{countIsrs $topicMetadata.Partitions}}</span>
                </td>
                <td class="text-center">
                    <a href="#" class="btn btn-sm btn-outline-primary" 
                       hx-get="/topic-details?name={{$topicName}}" 
                       hx-trigger="click" 
                       hx-target="body" 
                       hx-swap="outerHTML"
                       title="View details">
                        <i class="bi bi-eye"></i>
                    </a>
                </td>
            </tr>
            {{else}}
            <tr>
                <td colspan="5" class="text-center text-muted py-4">
                    <i class="bi bi-inbox" style="font-size: 2rem;"></i>
                    <p class="mt-2 mb-0">No topics found</p>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>
{{end}}

{{define "brokers"}}
<div class="table-responsive">
    <table class="table table-hover table-bordered mb-0">
        <thead class="table-light">
            <tr>
                <th><i class="bi bi-hash me-1"></i>Broker ID</th>
                <th><i class="bi bi-globe me-1"></i>Host</th>
                <th><i class="bi bi-ethernet me-1"></i>Port</th>
            </tr>
        </thead>
        <tbody>
            {{range .Brokers}}
            <tr>
                <td><span class="badge bg-primary">{{.ID}}</span></td>
                <td><code>{{.Host}}</code></td>
                <td>{{.Port}}</td>
            </tr>
            {{else}}
            <tr>
                <td colspan="3" class="text-center text-muted">No brokers available</td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>
{{end}}

{{define "clusterInfo"}}
    {{template "brokers" .}}
    {{ if eq .Status "DOWN" }}
    <div class="alert alert-danger mt-3 mb-0" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <strong>Warning:</strong> Kafka server is currently down or unreachable.
    </div>
    {{end}}
{{end}}